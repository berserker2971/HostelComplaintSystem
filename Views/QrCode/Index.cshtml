@{
    ViewData["Title"] = "QR Code Generator";
}

<h1>QR Code Generator</h1>
<p>Create a QR code for a specific hostel location.</p>
<hr />

<div class="row">
    <div class="col-md-4">
        <form asp-action="Index" method="post">
            <div class="form-group mb-3">
                <label for="location" class="control-label">Location Name</label>
                <input name="location" class="form-control" placeholder="e.g. 2nd Floor Washroom" />
                @if (ViewBag.ErrorMessage != null)
                {
                    <span class="text-danger">@ViewBag.ErrorMessage</span>
                }
            </div>
            <div class="form-group">
                <input type="submit" value="Generate QR Code" class="btn btn-primary" />
            </div>
        </form>
    </div>

    @if (ViewBag.QRCodeImage != null)
    {
        <div class="col-md-6 offset-md-1 text-center">
            <h3 class="mb-3">QR Code for: @ViewBag.GeneratedFor</h3>

            <img src="@ViewBag.QRCodeImage"
                 alt="Generated QR Code"
                 style="width: 180px; height: 180px; cursor: pointer; border-radius: 8px;"
                 data-bs-toggle="modal"
                 data-bs-target="#qrModal" />

            <p class="mt-3">
                <button type="button"
                        class="btn btn-outline-primary"
                        data-bs-toggle="modal"
                        data-bs-target="#qrModal">
                    View & Download
                </button>
            </p>
        </div>
    }
</div>

@if (ViewBag.QRCodeImage != null)
{
    <div class="modal fade" id="qrModal" tabindex="-1" aria-labelledby="qrModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="qrModalLabel">QR Code for @ViewBag.GeneratedFor</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body text-center">
                    <img src="@ViewBag.QRCodeImage"
                         alt="Generated QR Code"
                         style="max-width: 100%; height: auto; border-radius: 8px;" />
                </div>
                <div class="modal-footer">
                    <a asp-action="Download"
                       asp-route-location="@ViewBag.GeneratedFor"
                       class="btn btn-primary">
                        Download PNG
                    </a>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                </div>
            </div>
        </div>
    </div>
}
